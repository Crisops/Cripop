---
import Layout from "@/layouts/Layout.astro"
import ShowMoreSeries from "@/components/astro/ShowMoreSeries.astro";
import BoxMain from "@/components/react/BoxMain";
import BoxSearch from "@/components/react/BoxSearch";
import SearchMovieAndSeries from "@/components/astro/SearchMovieAndSeries.astro";

let page: string | null

if (Astro.url.searchParams.get("page") != null) {
  page = Astro.url.searchParams.get("page")
}else{
  page = "1"
}

const API_KEY = import.meta.env.SECRET_API_KEY
const URL_SERIES_POPULARITY = `https://api.themoviedb.org/3/tv/popular?api_key=${API_KEY}language=es&page=${page}`
---

<Layout title="Cripop - Series populares que no te puedes verder">
<BoxMain client:idle>
  <ShowMoreSeries url={URL_SERIES_POPULARITY} title="Encuentra la que te guste" choose="tv" page={page}/>
</BoxMain>
<BoxSearch client:idle>
  <SearchMovieAndSeries/>
</BoxSearch>
</Layout>