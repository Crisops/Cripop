---
import Layout from '@/layouts/Layout.astro'
import { tmdbUrls } from '@/services/tmdb/urls'
import { hasValidFilterParams } from '@/utils/validate-filter-search-params'
import ResultSearch from '@/components/astro/result-search.astro'
import Footer from '@/components/astro/footer.astro'

const page = Number(Astro.url.searchParams.get('page') ?? 1)

let URL_SERIES_TOP = ''

if (hasValidFilterParams(Astro.url.searchParams)) {
  URL_SERIES_TOP = tmdbUrls.discover('tv', Astro.url.search)
} else {
  URL_SERIES_TOP = tmdbUrls.lists.buildUrl('tv', 'top_rated', page)
}
---

<Layout title="Series mejores puntuadas - Cripop">
  <ResultSearch
    title="Las Series que Hacen Historia "
    description="Explora la élite de la televisión. Estas son las series que han superado el paso del tiempo, conquistado a la crítica y ganado un lugar en la historia. Si buscas programas inolvidables y con historias complejas, esta es la lista que estabas buscando"
    type="tv"
    url={URL_SERIES_TOP}
    page={page}
  />
  <Footer />
</Layout>
