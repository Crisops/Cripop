---
import Layout from '@/layouts/Layout.astro'
import { tmdbUrls } from '@/services/tmdb/urls'
import { hasValidFilterParams } from '@/utils/validate-filter-search-params'
import ResultSearch from '@/components/astro/result-search.astro'
import Footer from '@/components/astro/footer.astro'

const page = Number(Astro.url.searchParams.get('page') ?? 1)

let URL_MOVIES_TOP = ''

if (hasValidFilterParams(Astro.url.searchParams)) {
  URL_MOVIES_TOP = tmdbUrls.discover('movie', Astro.url.search)
} else {
  URL_MOVIES_TOP = tmdbUrls.lists.buildUrl('movie', 'top_rated', page)
}
---

<Layout
  title="Películas mejores puntuadas - Cripop"
  description="Revisa el panteón de las mejores películas de todos los tiempos."
  og={{
    url: '/movie/top',
    image: '/images/og/movie-top.jpg',
  }}
>
  <ResultSearch
    title="Los Clásicos del Futuro"
    description="Revisa el panteón de las mejores películas de todos los tiempos."
    type="movie"
    url={URL_MOVIES_TOP}
    page={page}
  />
  <Footer />
</Layout>
